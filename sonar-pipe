
node{
	
	stage('SCM Checkout'){
		git 'https://github.com/VenkyMadineni/devops-practices.git'
   }
   
	stage('BUILD'){
        sh 'mvn clean install -DskipTests'
        archiveArtifacts artifacts: '**/target/*.war'
        }

	stage('UNIT TEST'){
            
                sh 'mvn test'
          
        }

	stage('INTEGRATION TEST'){
            
                sh 'mvn verify -DskipUnitTests'
          
        }
		
        stage ('CODE ANALYSIS WITH CHECKSTYLE'){
            
                sh 'mvn checkstyle:checkstyle'
            
        }

        stage('CODE ANALYSIS with SONARQUBE') {
          
            withSonarQubeEnv('sonarscanner4') {
				sh '''mvn sonar:sonar \
					-Dsonar.projectKey=Vprofile \
					-Dsonar.host.url=http://192.168.33.10:9000 \
					-Dsonar.login=09717285218f66911b380336d140272b4400827e
					-Dsonar.projectVersion=1.0 \
					-Dsonar.sources=src/ \
					-Dsonar.java.binaries=target/test-classes/com/visualpathit/account/controllerTest/ \
					-Dsonar.junit.reportsPath=target/surefire-reports/ \
					-Dsonar.jacoco.reportsPath=target/jacoco.exec \
					-Dsonar.java.checkstyle.reportPaths=target/checkstyle-result.xml'''
            }
            
          }
        
   }



 